global.PACKER=function(){"use strict";var E=require("fs"),R=require("path"),S=__dirname,n=process.argv[2],e="",O="",r="",i="",C=function(E){console.log("PACKER: "+E)},c=function(R){var n=R.path,e=R.name;return E.statSync(S+"/"+n).isDirectory()===!0&&"."!==e[0]&&"node_modules"!==e&&"not_load"!==e&&"deprecated"!==e&&"_"!==e[0]},t=function(R,S){E.statSync(R).isDirectory()===!0?(E.mkdirSync(S),E.readdirSync(R).forEach(function(E){"."!==E[0]&&t(R+"/"+E,S+"/"+E)})):E.createReadStream(R).pipe(E.createWriteStream(S))},_=function(R,S){E.writeFileSync(R,S)},o=function(R,n){var e,O;if(E.existsSync(R)===!0)for(e=[],E.readdirSync(R).forEach(function(O){var r=R+"/"+O;c({path:r,name:O})===!0?e.push(r):E.statSync(S+"/"+r).isDirectory()!==!0&&n(r)}),O=0;O<e.length;O+=1)o(e[O],n)},A=function(R){E.readdirSync(n).forEach(function(E){"."!==E[0]&&"BROWSER"!==E&&"BROWSER_SECURED"!==E&&"COMMON"!==E&&"SERVER"!==E&&R(n+"/"+E)})},D=function(n){var O=S+"/"+n,r=R.extname(n),i=E.readFileSync(O);".js"===r?e+=i+"\n":".__UPPERCASE_COMPILED"===r&&(e+=i+"\n")},a=function(n){var e=S+"/"+n,r=R.extname(n),i=E.readFileSync(e);".js"===r?O+=i+"\n":".__UPPERCASE_COMPILED"===r&&(O+=i+"\n")},P=function(n){var e=S+"/"+n,O=R.extname(n),i=E.readFileSync(e);".js"===O?r+=i+"\n":".__UPPERCASE_COMPILED"===O&&(r+=i+"\n")},d=function(n){var e=S+"/"+n,O=R.extname(n),r=E.readFileSync(e);".js"===O?i+=r+"\n":".__UPPERCASE_COMPILED"===O&&(i+=r+"\n")},s=function(){var E=require(S+"/UPPERCASE/SERVER/node_modules/uglify-js");e=E.minify(e,{fromString:!0,mangle:!0}).code,O=E.minify(O,{fromString:!0,mangle:!0}).code,r=E.minify(r,{fromString:!0,mangle:!0}).code,i=E.minify(i,{fromString:!0,mangle:!0}).code};C("PACKING BOX ["+n+"]..."),C("CREATING FOLDER..."),E.mkdirSync("__PACK/"+n),C("CREATED FOLDER!"),C("LOADING BOX..."),C("LOADING FOR BROWSER..."),o(n+"/BROWSER",D),C("LOADED FOR BROWSER!"),C("LOADING FOR BROWSER SECURED..."),o(n+"/BROWSER_SECURED",a),C("LOADED FOR BROWSER SECURED!"),C("LOADING FOR COMMON..."),o(n+"/COMMON",P),C("LOADED FOR COMMON!"),C("LOADING FOR SERVER..."),o(n+"/SERVER",d),C("LOADED FOR SERVER!"),C("LOADED BOX!"),C("MINIFYING..."),s(),C("MINIFYED!"),C("SAVING BOX..."),A(function(E){t(E,"__PACK/"+n+"/"+E.substring(n.length+1))}),""!==e&&(C("SAVING BROWSER SCRIPT..."),E.mkdirSync("__PACK/"+n+"/BROWSER"),_("__PACK/"+n+"/BROWSER/BROWSER.js",e),C("SAVED BROWSER SCRIPT!")),""!==O&&(C("SAVING BROWSER SECURED SCRIPT..."),E.mkdirSync("__PACK/"+n+"/BROWSER_SECURED"),_("__PACK/"+n+"/BROWSER_SECURED/BROWSER_SECURED.js",O),C("SAVED BROWSER SECURED SCRIPT!")),""!==r&&(C("SAVING COMMON SCRIPT..."),E.mkdirSync("__PACK/"+n+"/COMMON"),_("__PACK/"+n+"/COMMON/COMMON.js",r),C("SAVED COMMON SCRIPT!")),""!==i&&(C("SAVING SERVER SCRIPT..."),E.mkdirSync("__PACK/"+n+"/SERVER"),_("__PACK/"+n+"/SERVER/SERVER.js",i),C("SAVED SERVER SCRIPT!")),E.existsSync(n+"/SERVER/node_modules")===!0&&(C("SAVING NODE MODULES..."),E.existsSync("__PACK/"+n+"/SERVER")===!1&&E.mkdirSync("__PACK/"+n+"/SERVER"),t(n+"/SERVER/node_modules","__PACK/"+n+"/SERVER/node_modules"),C("SAVED NODE MODULES!")),C("SAVED BOX!"),C("PACKED BOX ["+n+"]!")},PACKER();
